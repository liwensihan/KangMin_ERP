<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<base href="${pageContext.request.contextPath }/">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
 		<link rel="stylesheet" href="res/layui/css/layui.css">
		<script src="res/js/jquery-2.1.3.min.js" type="text/javascript" ></script>
		<script src="res/layui/layui.js"></script>
  <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
  <style>
  	.layui-table-view {
	    margin: 10px 18px;
	    overflow: hidden;
	}
	body{
		padding: 10px;
	}

	#sousuo td{
		padding-right: 5px;
		padding-top: 5px;
	}
	#sousuo .layui-input {
 		height: 40px;
 		width:150px;
	}
	#div{
		z-index: 19891018; 
		top:15%;
		left:32%;
		display: none;
		position: fixed;
		background-color: #fff;
		width:670px;
	}
	#div1{
		display: none;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		position: fixed;
		z-index: 19891014; 
		background-color: rgb(0, 0, 0); 
		opacity: 0.3;
	}
	
  </style>
</head>
<body> 
<div class="demoTable">
		 &nbsp;&nbsp;&nbsp;&nbsp;
		 <div class="layui-inline">
		  	<form class="layui-form" id="sousuo" style="float: left;">
		  		<table>
		  			<tr>
		  				<td>
		  				    <select id="depaName" name="depaName" lay-verify="required" lay-search="" width="50px">
							  <option value="">部门名称</option>
							</select>
		  				</td>
		  				<td>
			  				<select id="staSex" name="staSex" lay-verify="required" lay-search="" width="50px" >
							  <option value="">性别</option>
							  <option value="男">男</option>
							  <option value="女">女</option>
							</select>
		  				</td>
		  				<td>
			  				<select id="staName" name="staName" lay-verify="required" lay-search="" width="50px">
							  <option value="">员工姓名</option>
							</select>
		  				</td>
		  				<td>
			  				<select id="staAge" name="staAge" lay-verify="required" lay-search="" width="50px">
							  <option value="">年龄</option>
							</select>
		  				</td>
		  			</tr>
		  		</table>
			</form>
			<button class="layui-btn" style="margin-top: 5px;" data-type="reload">搜索</button>
		  </div>
		</div>

<table class="layui-table" lay-data="{width: 1151, height:472, url:'staff/findAll.action', page:true, limit: 10,id:'testReload',method:'post'}" lay-filter="demo">
  <thead>
    <tr>
      <th lay-data="{field:'staName', width:110, fixed: true, align:'center'}">员工姓名</th>
      <th lay-data="{field:'staImg', width:110, align:'center'}">员工照片</th>
      <th lay-data="{field:'depaName', width:110, align:'center'}">部门</th>
      <th lay-data="{field:'staSerial', width:110, align:'center'}">编号</th>
      <th lay-data="{field:'staEmail', width:110, align:'center'}">电话号码</th>
   	  <th lay-data="{field:'staAge', width:110, align:'center'}">年龄</th>
   	  <th lay-data="{field:'staSex', width:110, align:'center'}">性别</th>
   	  <th lay-data="{field:'staEntrytime', width:110, align:'center'}">入职时间</th>
   	  <th lay-data="{field:'staDimissiontime', width:110, align:'center'}">离职时间</th>
      
      <th lay-data="{fixed: 'right', width:150, align:'center', toolbar: '#barDemo'}"></th>
    </tr>
  </thead>
</table>
<script type="text/javascript">
	//同步
	$.ajaxSetup({
	  async:false
	});
	$(function(){
		url="staff/getStaff.action";
		$.post(url,null,function(m){
			for(i=0;i<m.length;i++){
				$("#staName").append("<option value='"+m[i].staName+"'>"+m[i].staName+"</option>");
				$("#staAge").append("<option value='"+m[i].staAge+"'>"+m[i].staAge+"</option>");
			}
		},"json")


		url="staff/getDepa.action";
		$.post(url,null,function(m){
			for(i=0;i<m.length;i++){
				$("#depaName").append("<option value='"+m[i].depaName+"'>"+m[i].depaName+"</option>");
			}
		},"json")
		
		
		url="staff/getDepa.action";
		$.post(url,null,function(m){
			for(i=0;i<m.length;i++){
				$("#ErpdepaName").append("<option value='"+m[i].depaName+"'>"+m[i].depaName+"</option>");
			}
		},"json")
	})
</script>
 
<script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-mini" lay-event="edit">编辑</a>
  <a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="del">删除</a>
</script>
               
          
<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
<script>
layui.use('table', function(){
  var table = layui.table;
  //监听表格复选框选择
  table.on('checkbox(demo)', function(obj){
    console.log(obj)
  });
  //监听工具条
  table.on('tool(demo)', function(obj){
    var data = obj.data;
    if(obj.event === 'detail'){
    	layer.open({
			type:2,
			skin: 'layui-layer-molv',//样式
			content:'pages/back/proshowadd.jsp?showId='+data.staId,
			area: ['75%', '80%'],
			title: '编辑商品展示',
		});	
    } else if(obj.event === 'del'){
      layer.confirm('真的删除行么', function(index){
        obj.del();
        url="staff/updateById.action";
    	date={id:data.staId};
    	$.post(url,date,function(m){
    		
    	},"json")
        layer.close(index);
      });
    } else if(obj.event === 'edit'){
    	url="staff/getDepa.action";
		$.post(url,null,function(m){
			for(i=0;i<m.length;i++){
				$("#depaName").append("<option value='"+m[i].depaId+"'>"+m[i].depaName+"</option>");
			}
		},"json")
    	 $("#div1").fadeIn(200);
    	 $("#div").fadeIn(200);
    }
  });
  
 
  var $ = layui.$, active = {
		    reload: function(){
		      var demoReload = $('#depaName');
		      var demoReload2 = $('#staSex');
		      var demoReload3 = $('#staAge');
		      var demoReload4 = $('#staName');
		      table.reload('testReload', {
		        where: {
		         
		        	depaName: demoReload.val(),
		         	staSex: demoReload2.val(),
		         	staAge: demoReload3.val(),
		         	staName: demoReload4.val()
		        }
		      });
		    }
		  };
  
  $('.demoTable .layui-btn').on('click', function(){
    var type = $(this).data('type');
    active[type] ? active[type].call(this) : '';
  });
});

	function quxiao(){
		$("#div1").fadeOut(200);
		$("#div").fadeOut(200);
	}
</script>
<div id="div1" times="1"></div>
<div  id="div" type="dialog" times="4" showtime="0" contype="string">
	<div class="layui-layer-title" style="cursor: move;margin-bottom: 25px;">编辑</div>
	<form class="layui-form" action="">
	  <div class="layui-form-item">
    <div class="layui-inline">
      <label class="layui-form-label">员工姓名</label>
      <div class="layui-input-inline">
        <input name="phone" lay-verify="phone" autocomplete="off" class="layui-input" type="tel">
      </div>
    </div>
    <div class="layui-inline">
      <label class="layui-form-label">员工编号</label>
      <div class="layui-input-inline">
        <input name="email" lay-verify="email" autocomplete="off" class="layui-input" type="text">
      </div>
    </div>
  </div>
    <div class="layui-form-item">
    <div class="layui-inline">
      <label class="layui-form-label">手机(账号)</label>
      <div class="layui-input-inline">
        <input name="phone" lay-verify="phone" autocomplete="off" class="layui-input" type="tel">
      </div>
    </div>
    <div class="layui-inline">
    <label class="layui-form-label">部门</label>
    <div class="layui-inline">
      <select id="ErpdepaName" lay-verify="required" lay-search="" width="50px">
		<option value="">部门名称</option>
	 </select>
    </div>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">自定义验证</label>
    <div class="layui-input-inline">
      <input name="password" lay-verify="pass" placeholder="请输入密码" autocomplete="off" class="layui-input" type="password">
    </div>
    <div class="layui-form-mid layui-word-aux">请填写6到12位密码</div>
  </div>
  <div class="layui-form-item">
  <div class="layui-inline">
      <label class="layui-form-label">年龄</label>
      <div class="layui-input-inline">
        <select name="modules" lay-verify="required" lay-search="">
          <option value="">直接选择或搜索选择</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12">12</option>
          <option value="13">13</option>
          <option value="14">14</option>
          <option value="15">15</option>
          <option value="16">16</option>
          <option value="17">17</option>
          <option value="18">18</option>
          <option value="19">19</option>
          <option value="20">20</option>
          <option value="21">21</option>
          <option value="22">22</option>
          <option value="23">23</option>
          <option value="24">24</option>
          <option value="25">25</option>
          <option value="26">26</option>
          <option value="27">27</option>
          <option value="28">28</option>
          <option value="29">29</option>
          <option value="30">30</option>
          <option value="31">31</option>
          <option value="32">32</option>
          <option value="33">33</option>
          <option value="34">34</option>
          <option value="35">35</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
        </select>
      </div>
    </div>
    <div class="layui-inline">
    <label class="layui-form-label">单选框</label>
    <div class="layui-inline">
      <input name="sex" value="男" title="男" checked="" type="radio">
      <input name="sex" value="女" title="女" type="radio">
    </div> 
    </div>
    </div>
	<span class="layui-layer-setwin"><a class="layui-layer-ico layui-layer-close layui-layer-close1" href="javascript:quxiao();"></a></span>
	<div class="layui-layer-btn layui-layer-btn-"><button class="layui-btn" lay-submit="" lay-filter="demo1">立即提交</button><a href="javascript:quxiao();">取消</a></div>
	<span class="layui-layer-resize"></span>
	</form>
</div>
<script type="text/javascript">
layui.use('upload', function(){
	  var $ = layui.jquery
	  ,upload = layui.upload;
	  
	  //普通图片上传
	  var uploadInst = upload.render({
	    elem: '#test1'
	    ,url: '/upload/'
	    ,before: function(obj){
	      //预读本地文件示例，不支持ie8
	      obj.preview(function(index, file, result){
	        $('#demo1').attr('src', result); //图片链接（base64）
	      });
	    }
	    ,done: function(res){
	      //如果上传失败
	      if(res.code > 0){
	        return layer.msg('上传失败');
	      }
	      //上传成功
	    }
	    ,error: function(){
	      //演示失败状态，并实现重传
	      var demoText = $('#demoText');
	      demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
	      demoText.find('.demo-reload').on('click', function(){
	        uploadInst.upload();
	      });
	    }
	  });
});
</script>
</body>
	
</html>